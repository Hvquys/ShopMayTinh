<nz-drawer (nzOnClose)="close()" [nzBodyStyle]="{ overflow: 'auto' }" [nzFooter]="footerTpl" [nzMaskClosable]="false"
           [nzVisible]="visible" [nzWidth]="1000" nzTitle="Thông tin đơn hàng">
  <div *nzDrawerContent nz-form nzLayout="vertical">
    <div *ngIf="order" nz-row>
      <div class="mg-b" nz-col nzSpan="24">
        <div nz-form nzLayout="vertical">
          <div nz-row>
            <div nz-col nzSpan="6">
              <nz-form-item>
                <nz-form-label>Mã đơn hàng</nz-form-label>
                <nz-form-control>
                  <input [value]="order.id" disabled nz-input nzSize="small" type="text"/>
                </nz-form-control>
              </nz-form-item>
            </div>
            <div nz-col nzSpan="6">
              <nz-form-item>
                <nz-form-label>Ngày đặt hàng</nz-form-label>
                <nz-form-control>
                  <input [value]="order.created | date:'HH:mm dd-MM-yyyy'" disabled nz-input
                         nzSize="small" type="text"/>
                </nz-form-control>
              </nz-form-item>
            </div>
            <div nz-col nzSpan="6">
              <nz-form-item>
                <nz-form-label>Trạng thái đơn hàng</nz-form-label>
                <nz-form-control>
                  <input [value]="order.status | orderStatus" disabled nz-input nzSize="small"
                         type="text"/>
                </nz-form-control>
              </nz-form-item>
            </div>
          </div>
        </div>
      </div>
      <div nz-col nzSpan="24">
        <h4>Chi tiết đơn hàng</h4>
        <nz-table [nzTemplateMode]="true" nzBordered>
          <thead>
          <tr style="background: #5189B9;color: white;">
            <th nzWidth="120px"></th>
            <th>Tên sản phẩm</th>
            <th nzWidth="120px">Giá</th>
            <th nzWidth="120px">Số lượng</th>
            <th nzWidth="120px">Thành tiền</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let orderDetail of order.orderDetails">
            <td nzAlign="center">
              <img [src]="orderDetail.productImage | fullPathResource"
                   style="width: 50px;border: 1px solid #dcdcdc;padding: 1px;min-width: 50px;" alt=""/>
            </td>
            <td>
              <div>
                {{ orderDetail.productName }}
              </div>
              <div *ngIf="orderDetail.attribute "
                   style="border: 1px solid #dcdcdc;display: inline-block;padding: 2px 5px 2px 10px;margin: 5px 0 0;">
                <div [innerHTML]="orderDetail.attribute"></div>
              </div>
            </td>
            <td class="text-right">
              <b class="mg-r">
                <small>
                  <s>
                    {{ orderDetail.productPrice | number }} ₫
                  </s>
                </small>
              </b>
              <b>
                {{ orderDetail.productDiscountPrice | number }} ₫
              </b>
            </td>
            <td nzAlign="center">
              {{ orderDetail.qty }}
            </td>
            <td class="text-right">
              <b>
                {{ (orderDetail.productDiscountPrice * orderDetail.qty) | number }} ₫
              </b>
            </td>
          </tr>
          <tr>
            <td class="text-right" colspan="4">
              <h4>Tổng tiền</h4>
            </td>
            <td class="text-right">
              <h4 style="color:red">
                {{ getTotalAmount | number }} ₫
              </h4>
            </td>
          </tr>
          </tbody>
        </nz-table>
      </div>
    </div>
  </div>

  <ng-template #footerTpl>
    <div style="float: right">
      <button (click)="close()" nz-button>Đóng</button>

      <ng-container *ngIf="order">
        <button (click)="updateStatus(50)"
                *ngIf="order.status == 10 || order.status == 20 || order.status == 30" nz-button nzDanger
                nzType="primary">
          Hủy đơn hàng
        </button>

        <button (click)="updateStatus(20)" *ngIf="order.status == 10" nz-button nzType="primary">
          Xác nhận đơn hàng
        </button>

        <button (click)="updateStatus(30)" *ngIf="order.status == 20" nz-button nzType="primary">
          Chuyển vận chuyển
        </button>

        <button (click)="updateStatus(40)" *ngIf="order.status == 30" nz-button nzType="primary">
          Hoàn thành giao hàng
        </button>
      </ng-container>

    </div>
  </ng-template>

</nz-drawer>
