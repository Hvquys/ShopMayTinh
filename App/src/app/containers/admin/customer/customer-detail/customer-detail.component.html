<nz-drawer (nzOnClose)="close()" [nzBodyStyle]="{ overflow: 'auto' }" [nzFooter]="footerTpl" [nzMaskClosable]="false"
           [nzVisible]="visible" [nzWidth]="900" nzTitle="Thông tin khách hàng">
  <div *nzDrawerContent nz-form nzLayout="vertical">
    <ng-container *ngIf="customer">
      <div nz-row>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label>Tên khách hàng</nz-form-label>
            <nz-form-control>
              <input [value]="customer.fullName" disabled nz-input nzSize="small" type="text"/>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label>Số điện thoại</nz-form-label>
            <nz-form-control>
              <input [value]="customer.phoneNumber" disabled nz-input nzSize="small" type="text"/>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label>Email</nz-form-label>
            <nz-form-control>
              <input [value]="customer.email" disabled nz-input nzSize="small" type="text"/>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label>Ngày sinh</nz-form-label>
            <nz-form-control>
              <input [value]="customer.dob | date:'dd-MM-yyyy'" disabled nz-input nzSize="small"
                     type="text"/>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label>Giới tính</nz-form-label>
            <nz-form-control>
              <input [value]="customer.gender" disabled nz-input nzSize="small" type="text"/>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="18">
          <nz-form-item>
            <nz-form-label>Địa chỉ</nz-form-label>
            <nz-form-control>
              <input [value]="customer.address" disabled nz-input nzSize="small" type="text"/>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>
      <div nz-row>
        <div class="mg-t" nz-col nzSpan="24">
          <h4>Đơn hàng đã đặt</h4>
          <div>
            <nz-table #tblData [nzShowTotal]="showTotalTpl" [nzData]="customer.orders" [nzPageSize]="100">
              <thead>
              <tr>
                <th>Mã đơn hàng</th>
                <th>Ngày đặt hàng</th>
                <th>Số điện thoại</th>
                <th>Địa chỉ liên hệ</th>
                <th>Tổng tiền</th>
                <th>Trạng thái</th>
                <th></th>
              </tr>
              </thead>
              <tbody>
              <tr *ngFor="let data of tblData.data">
                <td>{{ data.id }}</td>
                <td>{{ data.created | date:'HH:mm dd-MM-yyyy' }}</td>
                <td>{{ data.phoneNumber }}</td>
                <td>{{ data.address }}</td>
                <td class="text-right">{{ data.totalAmount | number }}</td>
                <td>{{ data.status | orderStatus }}</td>
                <td>
                  <a (click)="showOrderDetail(data)">Xem chi tiết</a>
                </td>
              </tr>
              </tbody>
            </nz-table>
            <ng-template #showTotalTpl let-range="range" let-total>
              {{ range[0] }}-{{ range[1] }} of {{ total | number }} bản ghi
            </ng-template>
          </div>
        </div>
      </div>
    </ng-container>
  </div>

  <ng-template #footerTpl>
    <div style="float: right">
      <button (click)="close()" nz-button>Đóng</button>
    </div>
  </ng-template>

</nz-drawer>


<nz-modal (nzOnCancel)="isVisibleModal = !isVisibleModal" [(nzVisible)]="isVisibleModal" [nzFooter]="modalFooter"
          [nzStyle]="{ top: '20px' }"
          [nzWidth]="1000" nzTitle="Chi tiết đơn hàng">
  <ng-container *nzModalContent>
    <div *ngIf="orderSelected" nz-row>
      <div nz-col nzSpan="24">
        <table class="table table-bordered">
          <tbody>
          <tr style="background: #5189B9;color: white;">
            <th colSpan="2">Tên sản phẩm</th>
            <th>Giá</th>
            <th>Số lượng</th>
            <th>Thành tiền</th>
          </tr>
          <tr *ngFor="let orderDetail of orderSelected.orderDetails">
            <td nzAlign="center">
              <img [src]="orderDetail.productImage | fullPathResource"
                   style="width: 50px;border: 1px solid #dcdcdc;padding: 1px;min-width: 50px;" alt=""/>
            </td>
            <td>
              <div>
                {{ orderDetail.productName }}
              </div>
              <div *ngIf="orderDetail.attribute && orderDetail.attribute != ''"
                   style="border: 1px solid #dcdcdc;display: inline-block;padding: 2px 5px 2px 10px;margin: 5px 0 0;">
                <div [innerHTML]="orderDetail.attribute"></div>
              </div>
            </td>
            <td class="text-right">
              <b class="mg-r">
                <small>
                  <s>
                    {{ orderDetail.productPrice | number }} ₫
                  </s>
                </small>
              </b>
              <b>
                {{ orderDetail.productDiscountPrice | number }} ₫
              </b>
            </td>
            <td nzAlign="center">
              {{ orderDetail.qty }}
            </td>
            <td class="text-right">
              <b>
                {{ (orderDetail.productDiscountPrice * orderDetail.qty) | number }} ₫
              </b>
            </td>
          </tr>
          <tr>
            <td class="text-right" colspan="4">
              <h4>Tổng tiền</h4>
            </td>
            <td class="text-right">
              <h4 style="color:red">
                {{ getTotalAmount | number }} ₫
              </h4>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>
  </ng-container>
  <ng-template #modalFooter>
    <nz-form-item>
      <nz-form-control>
        <button (click)="isVisibleModal = !isVisibleModal" nz-button>Đóng</button>
      </nz-form-control>
    </nz-form-item>
  </ng-template>
</nz-modal>
